<body>
<script>
var arr = [
        { text: "Company", id: "1", parentId:"" ,shortText:"",Icon:"",Links:""},
		{ text: "environment", id: "2", parentId: "1" ,shortText:"",Icon:"",Links:""},
		{ text: "cluster", id: "3", parentId: "2" ,shortText:"",Icon:"",Links:""},
		{ text: "component1", id: "4", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "Component2", id: "5", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "component3", id: "6", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "Blackline", id: "7", parentId:"" ,shortText:"",Icon:"",Links:""},
		{ text: "Service-Project:Production", id: "8", parentId: "1" ,shortText:"",Icon:"",Links:""},
		
		{ text: "USC1-PROD-POD1", id: "9", parentId: "2" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-WEB", id: "10", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-STS", id: "11", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-MicroServices", id: "12", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-Managed Data Query", id: "13", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-Reporting", id: "14", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-ConnectorsLink", id: "15", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-ConnectorsBackend", id: "16", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-Customer ENdpoint Simulator", id: "17", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-API Gateway Auth", id: "18", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-API Gateway STS", id: "19", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS Legacy services", id: "20", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS DAI", id: "21", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS EXCEL Import", id: "22", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS DMP", id: "23", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS Memcached", id: "24", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS SMP", id: "25", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS Redis", id: "26", parentId: "3" ,shortText:"",Icon:"",Links:""},
		{ text: "USC1-PRO-POD1-SQL", id: "27", parentId: "2" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-SQL-Cluster1", id: "28", parentId: "4" ,shortText:"",Icon:"",Links:""},
		{ text: "FCS-SQL-Cluster2", id: "29", parentId: "4" ,shortText:"",Icon:"",Links:""},
		{ text: "USC1-Prod-Prod-ENV", id: "30", parentId: "2" ,shortText:"",Icon:"",Links:""},
		{ text: "Mongo", id: "31", parentId: "5" ,shortText:"",Icon:"",Links:""},
		{ text: "Sophos", id: "32", parentId: "5" ,shortText:"",Icon:"",Links:""},
		{ text: "JAMS", id: "33", parentId: "5" ,shortText:"",Icon:"",Links:""},
		{ text: "JAMS scheduler", id: "34", parentId: "5.3" ,shortText:"",Icon:"",Links:""},
		{ text: "JAMS Agent", id: "35", parentId: "5.3" ,shortText:"",Icon:"",Links:""},
		{ text: "JAMS SQL", id: "36", parentId: "5.3" ,shortText:"",Icon:"",Links:""},
		{ text: "KAFKA", id: "37", parentId: "5" ,shortText:"",Icon:"",Links:""},
		{ text: "KAFKA_Brokers", id: "38", parentId: "5.4" ,shortText:"",Icon:"",Links:""},
		{ text: "KAFKA_ZOOKEEPER", id: "39", parentId: "5.4" ,shortText:"",Icon:"",Links:""},
		{ text: "KAFKA_AVRO_REPO", id: "40", parentId: "5.4" ,shortText:"",Icon:"",Links:""},
		{ text: "Service Project: prod-regcore-service", id: "41", parentId: "1" ,shortText:"",Icon:"",Links:""},
		{ text: "Management", id: "42", parentId: "6" ,shortText:"",Icon:"",Links:""},
		{ text: "ADControllers", id: "43", parentId: "7" ,shortText:"",Icon:"",Links:""},
		{ text: "CommonValut", id: "44", parentId: "7" ,shortText:"",Icon:"",Links:""},
		{ text: "Consul", id: "45", parentId: "7" ,shortText:"",Icon:"",Links:""},
		{ text: "FOgLight_Agent_mgr", id: "46", parentId: "7" ,shortText:"",Icon:"",Links:""},
		{ text: "SCOM Gateway", id: "47", parentId: "7" ,shortText:"",Icon:"",Links:""},
		{ text: "NetAppCloudManager", id: "48", parentId: "7" ,shortText:"",Icon:"",Links:""},
		{ text: "NetAppCloudOnTap", id: "49", parentId: "7" ,shortText:"",Icon:"",Links:""},
		{ text: "LogStash", id: "50", parentId: "7" ,shortText:"",Icon:"",Links:""},
		{ text: "Infosec", id: "51", parentId: "6" ,shortText:"",Icon:"",Links:""},
		{ text: "Nexpose", id: "52", parentId: "8" ,shortText:"",Icon:"",Links:""},
		{ text: "IDR", id: "53", parentId: "8" ,shortText:"",Icon:"",Links:""},
		{ text: "NetworkTrap", id: "54", parentId: "8" ,shortText:"",Icon:"",Links:""},
		{ text: "IDS", id: "55", parentId: "8" ,shortText:"",Icon:"",Links:""},
		{ text: "Service Project: prod-shared-service", id: "56", parentId: "1" ,shortText:"",Icon:"",Links:""},
		{ text: "Vault", id: "57", parentId: "5" ,shortText:"",Icon:"",Links:""},
		
		
    ],
    data = arr.reduce(function (r, a) {
        function getParent(s, b) {
            return b.id === a.parentId ? b : (b.nodes && b.nodes.reduce(getParent, s));
        }

        var index = 0, node;
        if ('parentId' in a) {
            node = r.reduce(getParent, {});
        }
        if (node && Object.keys(node).length) {
            node.nodes = node.nodes || [];
            node.nodes.push(a);
        } else {
            while (index < r.length) {
                if (r[index].parentId === a.id) {
                    a.nodes = (a.nodes || []).concat(r.splice(index, 1));
                } else {
                    index++;
                }
            }
            r.push(a);
        }
        return r;
    }, []);

 

//document.write('<pre>' + JSON.stringify(data, 0, 4) + '</pre>');
//document.write('<svg  style="position= absolute;top:50px width:1000px">  <line x1="0" y1="0" x2="5000" y2="2000" style="stroke:rgb(255,0,0);stroke-width:2" /></svg>');
document.write('<div style="postion:absolute"><h1>hello</h1>');

document.write('<svg style="z-index:-1;postion absolute;top:500px" >  <line x1="0" y1="0" x2="200" y2="2500" style="stroke:rgb(255,0,0);stroke-width:2" /></svg>');
read(data);
registerbuttonEvents(data);

function togglediv(dividlocal)
{
document.getElementById(dividlocal).style.display='none';
console.log('button triggered');
}
function read(jsonData){
for (var testobj in jsonData)
{
console.log("test----->"+jsonData[testobj].text);
console.log("length"+jsonData.length);
var colorSelector = ["aqua", "light-blue", "fuchsia", "grey", "light-green", "lime", "navy", "olive", "purple", "silver", "teal", "yellow","snow","gainsboro","gray79","plum1","pink1","orange1","wheat1"];
const random = Math.floor(Math.random() * colorSelector.length);
//var colorvar = Math.floor(Math.random()*16777215).toString(16);

document.write('<div style="position: relative;left:0;border:1px solid black;padding: 10px;border-spacing: 15px;margin:10px;min-width: 500px;min-height: 200px;background-color:'+colorSelector[random]+'">');

document.write('<div style="border:0px solid">');
document.write('<button id=btid'+jsonData[testobj].id+' style="float: right;border: none;background: none;font-size: 25px;">⊕ </button>');

document.write(jsonData[testobj].text);
document.write('</div>');
document.write('<div id=divid'+jsonData[testobj].id+'>');

document.getElementById('divid'+jsonData[testobj].id).onclick = togglediv('divid'+jsonData[testobj].id);


var tempbutton = document.getElementById('divid'+jsonData[testobj].id);
tempbutton.onclick = togglediv('divid'+jsonData[testobj].id);
tempbutton.addEventListener('click', event => event.preventDefault(), true);
if (jsonData.length>0 )
read(jsonData[testobj].nodes);
document.write('</div>');
document.write('</div>');
document.write('</div>');





}

}

function registerbuttonEvents(jsonData)
{
for (var testobj in jsonData)
{
var tempbutton = document.getElementById('divid'+jsonData[testobj].id);
document.body.addEventListener( 'click', function ( event ) {
  if( event.target.id == 'btid'+jsonData[testobj].id ) {
    //someFunc();
	console.log("testing");
	if(document.getElementById('divid'+jsonData[testobj].id).style.display == "none")
	{
	document.getElementById('divid'+jsonData[testobj].id).style.display = "block";
	document.getElementById('btid'+jsonData[testobj].id).innerText="⊖";
	}
	else
	{
	document.getElementById('divid'+jsonData[testobj].id).style.display = "none";
	document.getElementById('btid'+jsonData[testobj].id).innerText="⊕";
	
	}
  };
} );





console.log("test listener----->"+jsonData[testobj].text);
if (jsonData.length>0 )
registerbuttonEvents(jsonData[testobj].nodes);
}
}

</script>


</body>